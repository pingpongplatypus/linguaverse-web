rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    // Default read rule: allows authenticated users to read any document
    // Default write rule: denies all other writes by default
    match /{document=**} {
      allow read: if request.auth !=null;
      allow write: if false; // Still deny general writes
    }

    // --- NEW RULE FOR USERS COLLECTION ---
    // Allow anyone to create (add) new documents in the 'users' collection for testing purposes.
    // This is INSECURE FOR PRODUCTION for a 'create' that anyone can do.
    // For a real app, 'create' would often be linked to auth (e.g., allow create: if request.auth != null;)
    match /users/{userId} {
      // allow create: if true; // REMOVE or modify this for production
      allow create, update: if request.auth != null && request.auth.uid == userId; // <--- UPDATE TO THIS
      // allow delete: if false; // Deny delete by default, or add specific conditions
    }
  }
}
